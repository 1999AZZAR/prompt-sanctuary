{% extends "base.html" %}

{% block content %}
    <!-- Hero Section -->
    <div class="hero text-center mb-12 cursor-pointer" onclick="toggleSidePanel()">
        <div class="flex items-center justify-center mb-4 space-x-2">
            <h1 class="text-5xl font-bold"><i class="fas fa-cogs mr-2"></i>Prompt Generator (Basic)</h1>
        </div>
        <p class="text-lg text-gray-300">Create custom prompts tailored to your needs.</p>
    </div>

    <!-- Tools Section -->
    <div class="prompting grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-8">
        <!-- Text Prompt -->
        <div class="mdc-card glass prompt-card p-6 flex flex-col text-[var(--md-sys-color-on-surface)]">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold">Generate Text Prompt</h2>
                <button onclick="toggleHelp('text-help')" class="bg-[var(--md-sys-color-surface)] text-[var(--md-sys-color-on-surface)] px-3 py-1 rounded-lg hover:bg-[var(--md-sys-color-surface)] transition duration-200">?</button>
            </div>
            <div id="text-help" class="hidden bg-[var(--md-sys-color-surface)] p-4 rounded-lg mb-4 text-[var(--md-sys-color-on-surface)]">
                <p class="text-[var(--md-sys-color-on-surface)]">This section allows you to generate text prompts. Enter your input and click "Generate" to create a custom prompt, or click "Random" for a surprise prompt.</p>
            </div>
            <form id="text-prompt-form" class="space-y-4 flex-grow">
                <div>
                    <label for="user_input_text" class="block mb-2">Input:</label>
                    <input type="text" name="user_input" id="user_input_text" placeholder="Write a Python code" class="w-full p-3 bg-[var(--md-sys-color-surface)] rounded-lg text-[var(--md-sys-color-on-surface)]" required>
                </div>
                <div class="flex space-x-4">
                    <input type="submit" value="Generate" class="bg-[var(--md-sys-color-primary)] text-[var(--md-sys-color-on-primary)] px-6 py-3 rounded-lg hover:bg-[var(--md-sys-color-secondary)] transition duration-200 cursor-pointer">
                    <button type="button" onclick="submitForm('random-text-prompt-form','/generate/trandom')" class="bg-[var(--md-sys-color-secondary)] text-[var(--md-sys-color-on-secondary)] px-6 py-3 rounded-lg hover:opacity-90 transition duration-200">Random</button>
                </div>
            </form>

            <!-- Add the random-text-prompt-form here -->
            <form id="random-text-prompt-form" style="display: none;"></form>
        </div>

        <!-- Image Prompt -->
        <div class="mdc-card glass prompt-card p-6 flex flex-col text-[var(--md-sys-color-on-surface)]">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold">Generate Image Prompt</h2>
                <button onclick="toggleHelp('image-help')" class="bg-[var(--md-sys-color-surface)] text-[var(--md-sys-color-on-surface)] px-3 py-1 rounded-lg hover:bg-[var(--md-sys-color-surface)] transition duration-200">?</button>
            </div>
            <div id="image-help" class="hidden bg-[var(--md-sys-color-surface)] p-4 rounded-lg mb-4 text-[var(--md-sys-color-on-surface)]">
                <p class="text-[var(--md-sys-color-on-surface)]">This section allows you to generate image prompts. You can input text, upload an image, or choose a random prompt. Click "Generate" to create your prompt.</p>
            </div>
            <div class="space-y-4 flex-grow">
                <div class="input-radio flex space-x-4">
                    <label class="flex items-center space-x-2">
                        <input type="radio" id="text-input-option" name="prompt-option" value="text" checked onclick="togglePromptInput('text')">
                        <span>Text</span>
                    </label>
                    <label class="flex items-center space-x-2">
                        <input type="radio" id="image-upload-option" name="prompt-option" value="image" onclick="togglePromptInput('image')">
                        <span>File</span>
                    </label>
                </div>

                <!-- Text Input Section -->
                <form id="image-prompt-form" class="space-y-4">
                    <div>
                        <label for="user_input_image" class="block mb-2">Input:</label>
                        <input type="text" name="user_input" id="user_input_image" placeholder="Whale on the desert" class="w-full p-3 bg-[var(--md-sys-color-surface)] rounded-lg text-[var(--md-sys-color-on-surface)]" required>
                    </div>
                </form>

                <!-- Image Upload Section -->
                <form id="image-upload-form" enctype="multipart/form-data" class="space-y-4" style="display: none;">
                    <div>
                        <label for="image" class="block mb-2">Upload Image:</label>
                        <input type="file" name="image" accept="image/*" class="w-full p-3 bg-[var(--md-sys-color-surface)] rounded-lg text-[var(--md-sys-color-on-surface)]" required>
                    </div>
                </form>

                <!-- Buttons -->
                <div class="flex space-x-4">
                    <button id="generate-button" onclick="generatePrompt()" class="bg-[var(--md-sys-color-primary)] text-[var(--md-sys-color-on-primary)] px-6 py-3 rounded-lg hover:bg-[var(--md-sys-color-secondary)] transition duration-200">Generate</button>
                    <button type="button" onclick="submitForm('random-image-prompt-form','/generate/irandom')" class="bg-[var(--md-sys-color-secondary)] text-[var(--md-sys-color-on-secondary)] px-6 py-3 rounded-lg hover:opacity-90 transition duration-200">Random</button>
                </div>
                <!-- Hidden Random Form -->
                <form id="random-image-prompt-form" style="display: none;"></form>
            </div>
        </div>
    </div>

    <!-- Preview Section (hidden by default, shown only when image is uploaded) -->
    <div id="preview-container" class="image-preview mdc-card glass prompt-card p-6 mt-12 hidden">
        <img id="preview-image" alt="Image Preview" class="w-64 h-auto mx-auto rounded-lg object-contain">
    </div>

    <!-- Loading Section -->
    <div id="loading" class="loading hidden fixed inset-0 flex items-center justify-center z-50">
        <div class="glass absolute inset-0 z-0"></div>
        <div class="glass p-8 rounded-lg z-10 flex flex-col items-center justify-center">
            <div class="loader-modern"><div class="ring"></div><div class="ring ring2"></div><div class="pulse"></div></div>
            <h1 class="text-center mt-4 text-[var(--md-sys-color-on-surface)]">Generating...</h1>
        </div>
    </div>

    <!-- Result Section (hidden by default, shown only when a prompt is generated) -->
    <div id="resultSection" class="result mdc-card glass prompt-card p-6 mt-8 hidden">
        <h2 class="text-2xl font-bold mb-6">Generated Prompt:</h2>
        <div id="response" class="text-lg text-[var(--md-sys-color-on-surface)] space-y-4"></div>
        <div class="flex space-x-4 mt-6">
            <button onclick="copyToClipboard()" class="bg-[var(--md-sys-color-primary)] text-[var(--md-sys-color-on-primary)] px-6 py-3 rounded-lg hover:bg-[var(--md-sys-color-secondary)] transition duration-200">Copy</button>
            <button id="save-to-library" class="bg-[var(--md-sys-color-secondary)] text-[var(--md-sys-color-on-secondary)] px-6 py-3 rounded-lg hover:opacity-90 transition duration-200">Save</button>
        </div>
    </div>

    <script>
        function toggleHelp(helpId) {
            const helpDiv = document.getElementById(helpId);
            helpDiv.classList.toggle('hidden');
        }
    </script>
{% endblock %}
